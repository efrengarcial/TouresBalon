<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:ns="http://OrderManagement/OrderManagementBPArtifacts" xmlns:ns0="http://OrderManagementLib" xmlns:ns1="http://OrderManagementLib/OrderManagementIF" xmlns:ns10="http://OrderManagementLib/EmailServiceIF" xmlns:ns2="http://OrderManagementLib/CustomerServiceIF" xmlns:ns3="http://OrderManagementLib/ItemServiceIF" xmlns:ns4="http://OrderManagementLib/OrderServiceIF" xmlns:ns5="http://OrderManagement/FinancialOfficeBRIF" xmlns:ns6="http://OrderManagement/WarehouseOfficeBRIF" xmlns:ns7="http://OrderManagement/FinancialAuthorizationIF" xmlns:ns8="http://OrderManagement/WarehouseAuthorizationIF" xmlns:ns9="http://OrderManagementLib/WarehouseItemSplitIF" xmlns:tel="http://OrderManagement/Task1" xmlns:tel0="http://OrderManagement/Task2" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="OrderManagementBP" suppressJoinFailure="yes" targetNamespace="http://OrderManagement" wpc:continueOnError="no" wpc:displayName="OrderManagementBP" wpc:executionMode="longRunning" wpc:id="1" wpc:validFrom="2011-03-12T16:31:11" wpc:version="7.0.500">
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="OrderManagementIF.wsdl" namespace="http://OrderManagementLib/OrderManagementIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="OrderManagementIF.wsdl" namespace="http://OrderManagementLib/OrderManagementIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="xsd-includes/http.OrderManagementLib.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="OrderManagementBPArtifacts.wsdl" namespace="http://OrderManagement/OrderManagementBPArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="CustomerServiceIF.wsdl" namespace="http://OrderManagementLib/CustomerServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="ItemServiceIF.wsdl" namespace="http://OrderManagementLib/ItemServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="OrderServiceIF.wsdl" namespace="http://OrderManagementLib/OrderServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="FinancialOfficeBRIF.wsdl" namespace="http://OrderManagement/FinancialOfficeBRIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="WarehouseOfficeBRIF.wsdl" namespace="http://OrderManagement/WarehouseOfficeBRIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="FinancialAuthorizationIF.wsdl" namespace="http://OrderManagement/FinancialAuthorizationIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="WarehouseAuthorizationIF.wsdl" namespace="http://OrderManagement/WarehouseAuthorizationIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="WarehouseItemSplitIF.wsdl" namespace="http://OrderManagementLib/WarehouseItemSplitIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="EmailServiceIF.wsdl" namespace="http://OrderManagementLib/EmailServiceIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="OrderManagementInput.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="ReturnCode.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="Order.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="Item.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="Customer.xsd" namespace="http://OrderManagementLib"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="EmailOrder.xsd" namespace="http://OrderManagementLib"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="Interface" name="OrderManagementIF" partnerLinkType="ns:OrderManagementIFPLT" wpc:id="2"/>
    <bpws:partnerLink name="CustomerServiceIF" partnerLinkType="ns:nullPLT" partnerRole="Reference" wpc:id="10"/>
    <bpws:partnerLink name="ItemServiceIF" partnerLinkType="ns:nullPLT1" partnerRole="Reference" wpc:id="11"/>
    <bpws:partnerLink name="OrderServiceIF" partnerLinkType="ns:nullPLT2" partnerRole="Reference" wpc:id="12"/>
    <bpws:partnerLink name="FinancialOfficeBRIF" partnerLinkType="ns:nullPLT3" partnerRole="Reference" wpc:id="43"/>
    <bpws:partnerLink name="WarehouseOfficeBRIF" partnerLinkType="ns:nullPLT4" partnerRole="Reference" wpc:id="44"/>
    <bpws:partnerLink name="WarehouseItemSplitIF" partnerLinkType="ns:PartnerPLT" partnerRole="Reference" wpc:id="76"/>
    <bpws:partnerLink name="EmailServiceIF" partnerLinkType="ns:nullPLT5" partnerRole="Reference" wpc:id="82"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="orderManagementInput" type="ns0:OrderManagementInput" wpc:id="5"/>
    <bpws:variable name="customer" type="ns0:Customer" wpc:id="15"/>
    <bpws:variable name="customerRC" type="ns0:ReturnCode" wpc:id="16"/>
    <bpws:variable name="item" type="ns0:Item" wpc:id="17"/>
    <bpws:variable name="itemRC" type="ns0:ReturnCode" wpc:id="18"/>
    <bpws:variable name="order" type="ns0:Order" wpc:id="19"/>
    <bpws:variable name="orderRC" type="ns0:ReturnCode" wpc:id="20"/>
    <bpws:variable name="totalStockAtWarehouses" type="xsd:int" wpc:id="21"/>
    <bpws:variable name="processID" type="xsd:string" wpc:id="22"/>
    <bpws:variable name="financialRuleRC" type="ns0:ReturnCode" wpc:id="47"/>
    <bpws:variable name="warehouseRuleRC" type="ns0:ReturnCode" wpc:id="49"/>
    <bpws:variable name="emailOrder" type="ns0:EmailOrder" wpc:id="83"/>
  </bpws:variables>
  <bpws:sequence name="HiddenSequence" wpc:id="1073741827">
    <bpws:receive createInstance="yes" name="Receive" operation="createOrder" partnerLink="OrderManagementIF" portType="ns1:OrderManagementIF" wpc:displayName="Receive" wpc:id="4" wpc:transactionalBehavior="commitAfter">
      <wpc:output>
        <wpc:parameter name="orderManagementInput" variable="orderManagementInput"/>
      </wpc:output>
    </bpws:receive>
    <bpws:invoke name="Snippet" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Begin" wpc:id="13">
      <wpc:script>
        <wpc:javaCode><![CDATA[java.lang.String __result__1 = "OrderManagement process - Begin";
{// print to log
	System.out.println(__result__1);
}
]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="Assign" wpc:displayName="Init" wpc:id="23">
      <bpws:copy>
        <bpws:from variable="orderManagementInput">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[custID]]></bpws:query>
        </bpws:from>
        <bpws:to variable="customer">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[custID]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="orderManagementInput">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[itemID]]></bpws:query>
        </bpws:from>
        <bpws:to variable="item">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[itemID]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="orderManagementInput">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[itemQty]]></bpws:query>
        </bpws:from>
        <bpws:to variable="order">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[itemQty]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="orderManagementInput">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[submitterID]]></bpws:query>
        </bpws:from>
        <bpws:to variable="order">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[submitterID]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="totalStockAtWarehouses"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:flow name="OrderValidation" wpc:displayName="OrderValidation" wpc:id="24">
      <bpws:invoke name="RetrieveCustomerData" operation="retrieveCustomer" partnerLink="CustomerServiceIF" portType="ns2:CustomerServiceIF" wpc:continueOnError="inherit" wpc:displayName="RetrieveCustomerData" wpc:id="25">
        <wpc:input>
          <wpc:parameter name="customer" variable="customer"/>
        </wpc:input>
        <wpc:output>
          <wpc:parameter name="returnCode" variable="customerRC"/>
          <wpc:parameter name="customer" variable="customer"/>
        </wpc:output>
      </bpws:invoke>
      <bpws:invoke name="RetrieveItemDetails" operation="retrieveItem" partnerLink="ItemServiceIF" portType="ns3:ItemServiceIF" wpc:continueOnError="inherit" wpc:displayName="RetrieveItemDetails" wpc:id="26">
        <wpc:input>
          <wpc:parameter name="item" variable="item"/>
        </wpc:input>
        <wpc:output>
          <wpc:parameter name="item" variable="item"/>
          <wpc:parameter name="returnCode" variable="itemRC"/>
        </wpc:output>
      </bpws:invoke>
    </bpws:flow>
    <bpws:switch name="CheckIfBothCustomerAndItemExist" wpc:displayName="Check if both customer and item exist" wpc:id="27">
      <bpws:case wpc:displayName="Customer or Item does not exist" wpc:id="28">
        <bpws:condition><![CDATA[java.lang.String __result__5 = "99";
java.lang.String __result__4 = itemRC.getString("RC");
boolean __result__6;
{// text equal to
	__result__6 = __result__4.equals(__result__5);
}
java.lang.String __result__2 = "99";
java.lang.String __result__1 = customerRC.getString("RC");
boolean __result__3;
{// text equal to
	__result__3 = __result__1.equals(__result__2);
}
boolean __result__7;
{// or
	__result__7 = __result__3 || __result__6;
}
return __result__7;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="customerRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;99&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to" description="Whether or not the two strings of text are the same, including case" category="text" template="&lt;%return%> &lt;%input1%>.equals(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.6/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="itemRC.RC" field="true">
//    <dataOutputs target="//@executableElements.5/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;99&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.5/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to" description="Whether or not the two strings of text are the same, including case" category="text" template="&lt;%return%> &lt;%input1%>.equals(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.3/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.4/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.6/@parameters.1"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="or" description="If either input is true, the result is true" category="logic" template="&lt;%return%> &lt;%input1%> || &lt;%input2%>;">
//    <parameters name="input1" dataInputs="//@executableElements.2/@result/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.5/@result/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </parameters>
//    <result>
//      <dataOutputs target="//@executableElements.7"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.6/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3 //@executableElements.4 //@executableElements.5 //@executableElements.6 //@executableElements.7"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:8,1
//!SMAP!2:7,1
//!SMAP!3:9,4
//!SMAP!4:2,1
//!SMAP!5:1,1
//!SMAP!6:3,4
//!SMAP!7:13,4
//!SMAP!8:17,1
//!SMAP!1000000:95,1]]></bpws:condition>
        <bpws:sequence name="HiddenSequence1" wpc:id="1073741855">
          <bpws:empty name="EmptyAction" wpc:displayName="Error" wpc:id="32"/>
          <bpws:terminate name="Terminate" wpc:displayName="Terminate" wpc:id="33"/>
        </bpws:sequence>
      </bpws:case>
      <bpws:otherwise wpc:id="30">
        <bpws:sequence name="HiddenSequence2" wpc:id="1073741859">
          <bpws:invoke name="SetOrdercreationparameters" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set Order creation parameters" wpc:id="34">
            <wpc:script>
              <wpc:javaCode><![CDATA[order.setString("state","CREATED");
order.setInt("amount",(new Integer(item.getInt("price")*order.getInt("itemQty")).intValue()));
java.util.Calendar dCurrent= java.util.Calendar.getInstance();
order.setDate("creationDate",dCurrent.getTime());
order.setDate("completionDate",dCurrent.getTime());
processID= processInstance().getID().toString();
order.setString("ordID",processID);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="CreateOrder" operation="createOrder" partnerLink="OrderServiceIF" portType="ns4:OrderServiceIF" wpc:continueOnError="inherit" wpc:displayName="Create Order" wpc:id="36">
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="customer" variable="customer"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnCode" variable="orderRC"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:invoke name="Invoke4" operation="split" partnerLink="WarehouseItemSplitIF" portType="ns9:WarehouseItemSplitIF" wpc:continueOnError="inherit" wpc:displayName="Split Items Across Warehouses as shown" wpc:id="77">
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="item" variable="item"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:forEach counterName="w" name="ForEach" parallel="no" wpc:counterVariableId="81" wpc:displayName="ForEach" wpc:id="78">
            <bpws:startCounterValue expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[1]]></bpws:startCounterValue>
            <bpws:finalCounterValue expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[count($item/warehouses)]]></bpws:finalCounterValue>
            <bpws:scope name="Scope" wpc:id="80">
              <bpws:invoke name="CalculateTotalStock" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Add to Total Stock" wpc:id="37">
                <wpc:script>
                  <wpc:javaCode><![CDATA[commonj.sdo.DataObject __result__1;
{// create Warehouse
	com.ibm.websphere.bo.BOFactory factory = 
	   (com.ibm.websphere.bo.BOFactory) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOFactory");
	 __result__1 = factory.create("http://OrderManagementLib","Warehouse");
}
commonj.sdo.DataObject currentWarehouse = __result__1;
java.lang.Long __result__4 = new java.lang.Long(w.longValue() - 1);
java.util.List __result__3 = item.getList("warehouses");
java.lang.Object __result__5;
{// get item at index
	__result__5 = __result__3.get(((int)__result__4.longValue()));
}
currentWarehouse = (commonj.sdo.DataObject)__result__5;
java.lang.Integer __result__7 = new java.lang.Integer(currentWarehouse.getInt("stock") + totalStockAtWarehouses.intValue());
totalStockAtWarehouses = __result__7;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="create Warehouse" description="create a new Warehouse {http://OrderManagementLib}" category="SCA and BO services" template="com.ibm.websphere.bo.BOFactory factory = &#xA;   (com.ibm.websphere.bo.BOFactory) new com.ibm.websphere.sca.ServiceManager().locateService(&quot;com/ibm/websphere/bo/BOFactory&quot;);&#xA; &lt;%return%> factory.create(&quot;http://OrderManagementLib&quot;,&quot;Warehouse&quot;);">
//    <result>
//      <dataOutputs target="//@executableElements.1"/>
//      <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Warehouse" namespace="http://OrderManagementLib" nillable="false"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@result/@dataOutputs.0" value="currentWarehouse" localVariable="//@localVariables.0" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Warehouse" namespace="http://OrderManagementLib"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="item.warehouses" field="true">
//    <dataOutputs target="//@executableElements.4/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="w -1" assignable="false">
//    <dataOutputs target="//@executableElements.4/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="unsignedInt" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="get item at index" description="Get the item at the given index in the list" category="list" template="&lt;%return%> &lt;%list%>.get(&lt;%index%>);">
//    <parameters name="list" dataInputs="//@executableElements.2/@dataOutputs.0" displayName="list">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//    </parameters>
//    <parameters name="index" dataInputs="//@executableElements.3/@dataOutputs.0" displayName="index">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="int"/>
//    </parameters>
//    <result name="element" displayName="element">
//      <dataOutputs target="//@executableElements.5"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.4/@result/@dataOutputs.0" value="currentWarehouse" localVariable="//@localVariables.0" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Warehouse" namespace="http://OrderManagementLib"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="currentWarehouse.stock +  totalStockAtWarehouses" assignable="false">
//    <dataOutputs target="//@executableElements.7"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.6/@dataOutputs.0" value="totalStockAtWarehouses" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <localVariables name="currentWarehouse">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Warehouse" namespace="http://OrderManagementLib"/>
//  </localVariables>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//  <executableGroups executableElements="//@executableElements.2 //@executableElements.3 //@executableElements.4 //@executableElements.5"/>
//  <executableGroups executableElements="//@executableElements.6 //@executableElements.7"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,6
//!SMAP!2:7,1
//!SMAP!3:9,1
//!SMAP!4:8,1
//!SMAP!5:10,4
//!SMAP!6:14,1
//!SMAP!7:15,1
//!SMAP!8:16,1
//!SMAP!1000000:82,1]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:scope>
          </bpws:forEach>
        </bpws:sequence>
      </bpws:otherwise>
    </bpws:switch>
    <bpws:flow name="OrderFeasibility" wpc:displayName="OrderFeasibility" wpc:id="38">
      <bpws:links>
        <bpws:link name="Link" wpc:displayName="Link" wpc:id="46"/>
        <bpws:link name="Link1" wpc:displayName="Link1" wpc:id="52"/>
      </bpws:links>
      <bpws:invoke name="InvokeFinancialOfficeBR" operation="athorize" partnerLink="FinancialOfficeBRIF" portType="ns5:FinancialOfficeBRIF" wpc:continueOnError="inherit" wpc:displayName="InvokeFinancialOfficeBR" wpc:id="45">
        <wpc:input>
          <wpc:parameter name="item" variable="item"/>
          <wpc:parameter name="order" variable="order"/>
          <wpc:parameter name="customer" variable="customer"/>
        </wpc:input>
        <wpc:output>
          <wpc:parameter name="fincancialRuleRC" variable="financialRuleRC"/>
        </wpc:output>
        <bpws:sources>
          <bpws:source linkName="Link"/>
        </bpws:sources>
      </bpws:invoke>
      <bpws:invoke name="InvokeWarehouseOfficeBR" operation="athorize" partnerLink="WarehouseOfficeBRIF" portType="ns6:WarehouseOfficeBRIF" wpc:continueOnError="inherit" wpc:displayName="InvokeWarehouseOfficeBR" wpc:id="48">
        <wpc:input>
          <wpc:parameter name="totalStock" variable="totalStockAtWarehouses"/>
          <wpc:parameter name="order" variable="order"/>
        </wpc:input>
        <wpc:output>
          <wpc:parameter name="warehouseRuleRC" variable="warehouseRuleRC"/>
        </wpc:output>
        <bpws:sources>
          <bpws:source linkName="Link1"/>
        </bpws:sources>
      </bpws:invoke>
      <bpws:switch name="FinancialCheck" wpc:displayName="FinancialCheck" wpc:id="50">
        <bpws:targets>
          <bpws:target linkName="Link"/>
        </bpws:targets>
        <bpws:case wpc:displayName="Approve" wpc:id="51">
          <bpws:condition><![CDATA[java.lang.String __result__2 = "APPROVE";
java.lang.String __result__1 = financialRuleRC.getString("RC");
boolean __result__3;
{// text equal to (ignore case)
	__result__3 = __result__1.equalsIgnoreCase(__result__2);
}
return __result__3;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="financialRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;APPROVE&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.2/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:2,1
//!SMAP!2:1,1
//!SMAP!3:3,4
//!SMAP!4:7,1
//!SMAP!1000000:49,1]]></bpws:condition>
          <bpws:invoke name="LogApprove" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Approve" wpc:id="39">
            <wpc:script>
              <wpc:javaCode><![CDATA[System.out.println("Financial Check: Automatic Approval - BEGIN");
System.out.println("order.amount" + order.getInt("amount"));
System.out.println("customer.budget:" + customer.getInt("budget"));
System.out.println("customer.soldToDate:" + customer.getInt("soldToDate"));
System.out.println("Financial Check: Automatic Approval - END");]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
        </bpws:case>
        <bpws:case wpc:displayName="Reject" wpc:id="60">
          <bpws:condition><![CDATA[java.lang.String __result__2 = "REJECT";
java.lang.String __result__1 = financialRuleRC.getString("RC");
boolean __result__3;
{// text equal to (ignore case)
	__result__3 = __result__1.equalsIgnoreCase(__result__2);
}
return __result__3;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="financialRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;REJECT&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.2/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:2,1
//!SMAP!2:1,1
//!SMAP!3:3,4
//!SMAP!4:7,1
//!SMAP!1000000:49,1]]></bpws:condition>
          <bpws:invoke name="LogReject" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Reject" wpc:id="62">
            <wpc:script>
              <wpc:javaCode><![CDATA[System.out.println("Financial Check: Automatic Rejection - BEGIN");
System.out.println("order.amount" + order.getInt("amount"));
System.out.println("customer.budget:" + customer.getInt("budget"));
System.out.println("customer.soldToDate:" + customer.getInt("soldToDate"));
System.out.println("Financial Check: Automatic Rejection - END");]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
        </bpws:case>
        <bpws:otherwise wpc:id="56">
          <bpws:invoke name="Financialofficerauthorization" operation="athorize" partnerLink="null" portType="ns7:FinancialAuthorizationIF" wpc:continueOnError="inherit" wpc:displayName="Financial officer authorization" wpc:id="64">
            <wpc:task name="tel:OrderManagementBPTask1"/>
            <wpc:input>
              <wpc:parameter name="costumer" variable="customer"/>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="fincancialRuleRC" variable="financialRuleRC"/>
            </wpc:output>
          </bpws:invoke>
        </bpws:otherwise>
      </bpws:switch>
      <bpws:switch name="WarehouseCheck" wpc:displayName="WarehouseCheck" wpc:id="53">
        <bpws:targets>
          <bpws:target linkName="Link1"/>
        </bpws:targets>
        <bpws:case wpc:displayName="Approve" wpc:id="54">
          <bpws:condition><![CDATA[java.lang.String __result__2 = "APPROVE";
java.lang.String __result__1 = warehouseRuleRC.getString("RC");
boolean __result__3;
{// text equal to (ignore case)
	__result__3 = __result__1.equalsIgnoreCase(__result__2);
}
return __result__3;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="warehouseRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;APPROVE&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.2/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:2,1
//!SMAP!2:1,1
//!SMAP!3:3,4
//!SMAP!4:7,1
//!SMAP!1000000:49,1]]></bpws:condition>
          <bpws:invoke name="LogApprove1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Approve" wpc:id="55">
            <wpc:script>
              <wpc:javaCode><![CDATA[System.out.println("Warehouse Check: Automatic Approval - BEGIN");
System.out.println("order.itemQty" + order.getInt("itemQty"));
System.out.println("Warehouse Check: Automatic Approval - END");]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
        </bpws:case>
        <bpws:case wpc:displayName="Reject" wpc:id="61">
          <bpws:condition><![CDATA[java.lang.String __result__2 = "REJECT";
java.lang.String __result__1 = warehouseRuleRC.getString("RC");
boolean __result__3;
{// text equal to (ignore case)
	__result__3 = __result__1.equalsIgnoreCase(__result__2);
}
return __result__3;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="warehouseRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;REJECT&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.2/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:2,1
//!SMAP!2:1,1
//!SMAP!3:3,4
//!SMAP!4:7,1
//!SMAP!1000000:49,1]]></bpws:condition>
          <bpws:invoke name="Snippet2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Reject" wpc:id="63">
            <wpc:script>
              <wpc:javaCode><![CDATA[System.out.println("Warehouse Check: Automatic Rejection - BEGIN");
System.out.println("order.itemQty:" + order.getInt("itemQty"));
System.out.println("totalStockAtWarehouses:" + totalStockAtWarehouses);
System.out.println("Warehouse Check: Automatic Rejection - END");]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
        </bpws:case>
        <bpws:otherwise wpc:id="57">
          <bpws:invoke name="Warehouseofficerauthorization" operation="athorize" partnerLink="null" portType="ns8:WarehouseAuthorizationIF" wpc:continueOnError="inherit" wpc:displayName="Warehouse officer authorization" wpc:id="65">
            <wpc:task name="tel0:OrderManagementBPTask2"/>
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="order" variable="order"/>
              <wpc:parameter name="customer" variable="customer"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="warehouseRuleRC" variable="warehouseRuleRC"/>
              <wpc:parameter name="item" variable="item"/>
            </wpc:output>
          </bpws:invoke>
        </bpws:otherwise>
      </bpws:switch>
    </bpws:flow>
    <bpws:switch name="FinalVerification" wpc:displayName="Final Verification" wpc:id="40">
      <bpws:case wpc:displayName="ConfirmOrder" wpc:id="41">
        <bpws:condition><![CDATA[java.lang.String __result__5 = "APPROVE";
java.lang.String __result__4 = warehouseRuleRC.getString("RC");
boolean __result__6;
{// text equal to (ignore case)
	__result__6 = __result__4.equalsIgnoreCase(__result__5);
}
java.lang.String __result__2 = "APPROVE";
java.lang.String __result__1 = financialRuleRC.getString("RC");
boolean __result__3;
{// text equal to (ignore case)
	__result__3 = __result__1.equalsIgnoreCase(__result__2);
}
boolean __result__7;
{// and
	__result__7 = __result__3 && __result__6;
}
return __result__7;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="financialRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;APPROVE&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.6/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="warehouseRuleRC.RC" field="true">
//    <dataOutputs target="//@executableElements.5/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;APPROVE&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.5/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="text equal to (ignore case)" description="Whether or not the two strings of text are the same, ignoring case" category="text" template="&lt;%return%> &lt;%input1%>.equalsIgnoreCase(&lt;%input2%>);">
//    <parameters name="input1" dataInputs="//@executableElements.3/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.4/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.String"/>
//    </parameters>
//    <result name="are words equal" displayName="are words equal">
//      <dataOutputs target="//@executableElements.6/@parameters.1"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="and" description="If both inputs are true, the result is true" category="logic" template="&lt;%return%> &lt;%input1%> &amp;&amp; &lt;%input2%>;">
//    <parameters name="input1" dataInputs="//@executableElements.2/@result/@dataOutputs.0" displayName="input 1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.5/@result/@dataOutputs.0" displayName="input 2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </parameters>
//    <result>
//      <dataOutputs target="//@executableElements.7"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.6/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3 //@executableElements.4 //@executableElements.5 //@executableElements.6 //@executableElements.7"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:8,1
//!SMAP!2:7,1
//!SMAP!3:9,4
//!SMAP!4:2,1
//!SMAP!5:1,1
//!SMAP!6:3,4
//!SMAP!7:13,4
//!SMAP!8:17,1
//!SMAP!1000000:95,1]]></bpws:condition>
        <bpws:sequence name="HiddenSequence3" wpc:id="1073741892">
          <bpws:invoke name="EmptyAction1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Init Update Order" wpc:id="67">
            <wpc:script>
              <wpc:javaCode><![CDATA[order.setString("state", "CONFIRMED");
java.util.Date dCurrent = new java.util.Date();
order.setDate("completionDate", dCurrent);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Invoke" operation="updateOrder" partnerLink="OrderServiceIF" portType="ns4:OrderServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Order -- CONFIRMED" wpc:id="69">
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="customer" variable="customer"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnCode" variable="orderRC"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:invoke name="Invoke1" operation="updateItem" partnerLink="ItemServiceIF" portType="ns3:ItemServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Item" wpc:id="70">
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnCode" variable="itemRC"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:invoke name="Snippet3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Init Update Customer" wpc:id="72">
            <wpc:script>
              <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(customer.getInt("soldToDate") + order.getInt("amount"));
int __local__2 = __result__1.intValue();
customer.setInt("soldToDate", __local__2);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="customer.soldToDate + order.amount" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="customer.soldToDate" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,2
//!SMAP!1000000:26,1]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Invoke2" operation="updateCustomer" partnerLink="CustomerServiceIF" portType="ns2:CustomerServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Customer" wpc:id="71">
            <wpc:input>
              <wpc:parameter name="customer" variable="customer"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnCode" variable="customerRC"/>
            </wpc:output>
          </bpws:invoke>
        </bpws:sequence>
      </bpws:case>
      <bpws:otherwise wpc:id="66">
        <bpws:sequence name="HiddenSequence4" wpc:id="1073741898">
          <bpws:invoke name="Snippet4" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Init Update Order" wpc:id="73">
            <wpc:script>
              <wpc:javaCode><![CDATA[order.setString("ordID", processID);
order.setString("state", "SUSPENDED");
java.util.Date dCurrent = new java.util.Date();
order.setDate("completionDate", dCurrent);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Invoke3" operation="updateOrder" partnerLink="OrderServiceIF" portType="ns4:OrderServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Order -- SUSPENDED" wpc:id="75">
            <wpc:input>
              <wpc:parameter name="item" variable="item"/>
              <wpc:parameter name="customer" variable="customer"/>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnCode" variable="orderRC"/>
            </wpc:output>
          </bpws:invoke>
        </bpws:sequence>
      </bpws:otherwise>
    </bpws:switch>
    <bpws:invoke name="Snippet5" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Init e-mail" wpc:id="84">
      <wpc:script>
        <wpc:javaCode><![CDATA[/*************** INITIALIZE EmailOrder BEFORE FIRST USE ***************/
commonj.sdo.DataObject __result__1;
{// create EmailOrder
	com.ibm.websphere.bo.BOFactory factory = 
	   (com.ibm.websphere.bo.BOFactory) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOFactory");
	 __result__1 = factory.create("http://OrderManagementLib","EmailOrder");
}
emailOrder = __result__1;

/*************** SET THE FROM & TO ***************/
emailOrder.setString("to", orderManagementInput.getString("submitterEmail") );
//change the from email to your own sender's e-mail address
//emailOrder.setString("from", "admin@kcg16hw.itso.ral.ibm.com");
emailOrder.setString("from", "efren.gl@gmail.com");

/*************** SET THE SUBJECT ***************/
String ordID = order.getString("ordID");
String subjectType = ( financialRuleRC.getString("RC").equalsIgnoreCase("REJECT") 
	&& warehouseRuleRC.getString("RC").equalsIgnoreCase("REJECT") ) ? "rejected" : "accepted";
emailOrder.setString("subject", new String("Order: "+ordID+" has been "+subjectType));

/*************** SET THE EMAIL CONTENT ***************/
StringBuffer sb=new StringBuffer();
String fResult = financialRuleRC.getString("RC").equalsIgnoreCase("REJECT") ? "rejected" : "accepted";
sb.append("Order has been "+fResult+" by Financial Officer \n");
sb.append("---- Customer & Order information ---- \n");
sb.append("Customer ID: " + customer.getString("custID") + " \n");
sb.append("Customer name: " + customer.getString("custName") + " \n");
sb.append("Order amount: " + order.getInt("amount") + " \n");
sb.append("Budget: " + customer.getInt("budget") + " \n");
sb.append("Sold To Date: " + customer.getInt("soldToDate")+ " \n");
sb.append(" \n");
sb.append(" \n");
String wResult = warehouseRuleRC.getString("RC").equalsIgnoreCase("REJECT") ? "rejected" : "accepted";
sb.append("Order has been "+wResult+" by Warehouse Officer \n");
sb.append("---- Order & Item information ---- \n");
sb.append("Item ID: " + item.getString("itemID") + " \n");
sb.append("Item name: " + item.getString("itemName")+" \n");
sb.append("Order itemQty: " + order.getInt("itemQty")+" \n");
sb.append("Item total stock: " + totalStockAtWarehouses.intValue() );
sb.append(" \n");
sb.append(" \n");
sb.append(" \n");
sb.append(" \n");
sb.append(" \n");
sb.append(" \n");
sb.append("#### Email sent by a system id. Don't reply to it ####");
emailOrder.setString("body", new String(sb.toString()) );
]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="Invoke5" operation="sendEmail" partnerLink="EmailServiceIF" portType="ns10:EmailServiceIF" wpc:continueOnError="inherit" wpc:displayName="Send e-mail to submitter" wpc:id="85">
      <wpc:input>
        <wpc:parameter name="emailOrderSuspend" variable="emailOrder"/>
      </wpc:input>
    </bpws:invoke>
    <bpws:invoke name="Snippet1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log End" wpc:id="14">
      <wpc:script>
        <wpc:javaCode><![CDATA[java.lang.String __result__1 = "OrderManagement process - End";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;OrderManagement process - End&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
  </bpws:sequence>
</bpws:process>