<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:ns="http://OrderManagement/com/touresbalon/businessprocess/OrderProcessingBPArtifacts" xmlns:ns0="http://OrderManagementLib/com/touresbalon/bo" xmlns:ns1="http://OrderManagementLib/com/touresbalon/interfaces/OrderManagementIF" xmlns:ns10="http://PaymentsModuleLib/com/touresbalon/interfaces/PaymentServiceIF" xmlns:ns11="http://PaymentsModuleLib/com/touresbalon/bo" xmlns:ns12="http://TaskServices-LegalizeOrder/com/touresbalon/taskservices/LegalizeOrderBPInterface" xmlns:ns13="http://OrderManagementLib/com/touresbalon/interfaces/TransportCallbackIF" xmlns:ns14="http://OrderManagementLib/com/touresbalon/interfaces/AccommodationCallbackIF" xmlns:ns2="http://OrderModule/com/touresbalon/interfaces/OrderServiceIF" xmlns:ns3="http://orders.oms.touresbalon.com/" xmlns:ns4="http://OrderLib/com/touresbalon/interfaces/OrderMgmtServiceIF" xmlns:ns5="http://CommonDomain/com/touresbalon/bo" xmlns:ns6="http://OrderManagementLib/com/touresbalon/interfaces/SalesAuthorizationIF" xmlns:ns7="http://ProductReservationLib/com/touresbalon/interfaces/ProductReserServiceIF" xmlns:ns8="http://OrderManagement/com/touresbalon/businessprocess" xmlns:ns9="http://OrderManagementLib/com/touresbalon/interfaces/SecureTicketingIF" xmlns:tel="http://OrderManagement/com/touresbalon/businessprocess/Task1" xmlns:tel0="http://OrderManagement/com/touresbalon/businessprocess/Task2" xmlns:tel1="http://OrderManagement/com/touresbalon/businessprocess/Task3" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="OrderProcessingBP" suppressJoinFailure="yes" targetNamespace="http://OrderManagement/com/touresbalon/businessprocess" wpc:autoDelete="no" wpc:continueOnError="no" wpc:displayName="OrderProcessingBP" wpc:executionMode="longRunning" wpc:id="1" wpc:validFrom="2014-04-25T22:02:52" wpc:version="IBM_7.0.500">
  <wpc:adminTask name="tel0:OrderProcessingBPAdministrationTask"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/OrderManagementLib/com/touresbalon/interfaces/OrderManagementIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/OrderManagementIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/OrderManagementIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/OrderManagementIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/Order.xsd" namespace="http://OrderManagementLib/com/touresbalon/bo"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="OrderProcessingBPArtifacts.wsdl" namespace="http://OrderManagement/com/touresbalon/businessprocess/OrderProcessingBPArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/OrderLib/com/touresbalon/interfaces/OrderServiceIF.wsdl" namespace="http://OrderModule/com/touresbalon/interfaces/OrderServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/OrderServiceIF.wsdl" namespace="http://OrderModule/com/touresbalon/interfaces/OrderServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/OrderLib/com/touresbalon/interfaces/OrderMgmtServiceIF.wsdl" namespace="http://OrderLib/com/touresbalon/interfaces/OrderMgmtServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/OrderMgmtServiceIF.wsdl" namespace="http://OrderLib/com/touresbalon/interfaces/OrderMgmtServiceIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/ReturnCode.xsd" namespace="http://CommonDomain/com/touresbalon/bo"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/SalesAuthorizationIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/SalesAuthorizationIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/ProductReservationLib/com/touresbalon/interfaces/ProductReservationServiceIF.wsdl" namespace="http://ProductReservationLib/com/touresbalon/interfaces/ProductReserServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/ProductReservationServiceIF.wsdl" namespace="http://ProductReservationLib/com/touresbalon/interfaces/ProductReserServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/SecureTicketingIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/SecureTicketingIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/PaymentsModuleLib/com/touresbalon/interfaces/PaymentServiceIF.wsdl" namespace="http://PaymentsModuleLib/com/touresbalon/interfaces/PaymentServiceIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/PaymentServiceIF.wsdl" namespace="http://PaymentsModuleLib/com/touresbalon/interfaces/PaymentServiceIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/Payment.xsd" namespace="http://PaymentsModuleLib/com/touresbalon/bo"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/AccountingTransactionsLib/com/touresbalon/interfaces/LegalizeOrderServiceIF.wsdl" namespace="http://TaskServices-LegalizeOrder/com/touresbalon/taskservices/LegalizeOrderBPInterface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/LegalizeOrderServiceIF.wsdl" namespace="http://TaskServices-LegalizeOrder/com/touresbalon/taskservices/LegalizeOrderBPInterface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/BusinessErrorFault.xsd" namespace="http://CommonDomain/com/touresbalon/bo"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/OrderManagementLib/com/touresbalon/interfaces/TransportCallbackIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/TransportCallbackIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/TransportCallbackIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/TransportCallbackIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/TransportResponse.xsd" namespace="http://OrderManagementLib/com/touresbalon/bo"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/OrderManagementLib/com/touresbalon/interfaces/AccommodationCallbackIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/AccommodationCallbackIF"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../interfaces/AccommodationCallbackIF.wsdl" namespace="http://OrderManagementLib/com/touresbalon/interfaces/AccommodationCallbackIF"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../bo/LodgingResponse.xsd" namespace="http://OrderManagementLib/com/touresbalon/bo"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="Interface" name="OrderManagementIF" partnerLinkType="ns:OrderManagementIFPLT" wpc:id="2"/>
    <bpws:partnerLink name="OrderMgmtServiceIFPartner" partnerLinkType="ns:OrderMgmtServiceIFPLT" partnerRole="Interface" wpc:id="16"/>
    <bpws:partnerLink name="ProductReservationServiceIFPartner" partnerLinkType="ns:ProductReservationServiceIFPLT" partnerRole="Interface" wpc:id="43"/>
    <bpws:partnerLink name="PaymentServiceIFPartner" partnerLinkType="ns:PaymentServiceIFPLT" partnerRole="Interface" wpc:id="92"/>
    <bpws:partnerLink name="LegalizeOrderServiceIFPartner" partnerLinkType="ns:LegalizeOrderServiceIFPLT" partnerRole="Interface" wpc:id="104"/>
    <bpws:partnerLink myRole="Interface" name="TransportCallbackIF" partnerLinkType="ns:TransportCallbackIFPLT" wpc:id="177"/>
    <bpws:partnerLink myRole="Interface" name="AccommodationCallbackIF" partnerLinkType="ns:AccommodationCallbackIFPLT" wpc:id="179"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="order" type="ns0:Order" wpc:id="5"/>
    <bpws:variable name="orderID" type="ns5:ReturnCode" wpc:id="13"/>
    <bpws:variable name="orderOMS" type="ns3:Order" wpc:id="14"/>
    <bpws:variable name="returnValidateOrder" type="xsd:boolean" wpc:id="18"/>
    <bpws:variable name="returnAppovalOrder" type="xsd:boolean" wpc:id="23"/>
    <bpws:variable name="returnUpateOrder" type="ns5:ReturnCode" wpc:id="34"/>
    <bpws:variable name="returnMakeReservationAcco" type="ns5:ReturnCode" wpc:id="47"/>
    <bpws:variable name="returnMakeReservationTrans" type="ns5:ReturnCode" wpc:id="48"/>
    <bpws:variable name="returnCancelReservation" type="ns5:ReturnCode" wpc:id="52"/>
    <bpws:variable name="productConfirm" type="xsd:boolean" wpc:id="88"/>
    <bpws:variable name="payment" type="ns11:Payment" wpc:id="97"/>
    <bpws:variable name="returnApplyPayment" type="ns5:ReturnCode" wpc:id="98"/>
    <bpws:variable name="returnLegalizeOrder" type="ns5:ReturnCode" wpc:id="106"/>
    <bpws:variable name="now" type="xsd:dateTime" wpc:id="107"/>
    <bpws:variable name="userCancelationFault" type="ns5:BusinessErrorFault" wpc:id="128"/>
    <bpws:variable name="transportResponse" type="ns0:TransportResponse" wpc:id="178"/>
    <bpws:variable name="lodgingResponse" type="ns0:LodgingResponse" wpc:id="182"/>
  </bpws:variables>
  <bpws:correlationSets>
    <bpws:correlationSet name="OrderID_CS" properties="ns:OrderID_CP" wpc:id="131"/>
  </bpws:correlationSets>
  <bpws:faultHandlers>
    <bpws:catch faultName="ns8:UserCancelation" wpc:displayName="Catch" wpc:id="165">
      <bpws:sequence name="HiddenSequence4" wpc:id="1073741990">
        <bpws:invoke name="Snippet12" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log Fault" wpc:id="175">
          <wpc:script>
            <wpc:javaCode><![CDATA[com.ibm.bpe.api.BpelException bpelexception = getCurrentFaultAsException();
System.out.println("Fault  Name" + bpelexception.getFaultName());
bpelexception.printStackTrace( System.out);
Throwable rootCause = bpelexception.getRootCause();
]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:compensate name="Compensate1" scope="Reservation" wpc:displayName="Compensate" wpc:id="140"/>
        <bpws:assign name="Assign7" wpc:displayName="Assign Order RECHAZADA" wpc:id="150">
          <bpws:copy>
            <bpws:from><![CDATA[RECHAZADA]]></bpws:from>
            <bpws:to variable="orderOMS">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[status]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="Invoke11" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Oder -- RECHAZADA" wpc:id="151">
          <wpc:input>
            <wpc:parameter name="request" variable="orderOMS"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="response" variable="returnUpateOrder"/>
          </wpc:output>
        </bpws:invoke>
        <bpws:invoke name="Snippet10" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Order" wpc:id="152">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Process Terminate....=" + order.getString("orderID");
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Process Terminate....=&quot; + order.orderID" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:terminate name="Terminate3" wpc:displayName="Terminate" wpc:id="141"/>
      </bpws:sequence>
    </bpws:catch>
  </bpws:faultHandlers>
  <bpws:eventHandlers>
    <bpws:onEvent operation="cancelProcess" partnerLink="OrderManagementIF" portType="ns1:OrderManagementIF" wpc:displayName="OnEvent" wpc:id="132">
      <wpc:output>
        <wpc:parameter name="orderID" type="xsd:string" variable="orderID" wpc:variableId="133" wpc:variableIsBusinessRelevant="no"/>
      </wpc:output>
      <bpws:correlations>
        <bpws:correlation initiate="no" set="OrderID_CS"/>
      </bpws:correlations>
      <bpws:sequence name="HiddenSequence10" wpc:id="1073741969">
        <bpws:invoke name="Snippet9" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Order" wpc:id="143">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Cancelation Order....=" + order.getString("orderID");
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Cancelation Order....=&quot; + order.orderID" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:throw faultName="ns8:UserCancelation" name="UserCancelation" wpc:displayName="User Cancelation" wpc:id="146"/>
      </bpws:sequence>
    </bpws:onEvent>
  </bpws:eventHandlers>
  <bpws:sequence name="HiddenSequence" wpc:id="1073741827">
    <bpws:receive createInstance="yes" name="Receive" operation="startProcess" partnerLink="OrderManagementIF" portType="ns1:OrderManagementIF" wpc:displayName="Receive" wpc:id="4" wpc:transactionalBehavior="commitAfter">
      <wpc:output>
        <wpc:parameter name="request" variable="order"/>
      </wpc:output>
      <bpws:correlations>
        <bpws:correlation initiate="yes" set="OrderID_CS"/>
      </bpws:correlations>
    </bpws:receive>
    <bpws:invoke name="DataMap" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="DataMap" wpc:id="125">
      <wpc:script>
        <wpc:javaCode><![CDATA[commonj.sdo.DataObject __result__2;
{// create Order
	com.ibm.websphere.bo.BOFactory factory = 
	   (com.ibm.websphere.bo.BOFactory) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOFactory");
	 __result__2 = factory.create("http://orders.oms.touresbalon.com/","Order");
}
orderOMS = __result__2;
java.lang.Object __result__4 = null;
try {
	{// dataMappingCreateOrder
		java.util.HashMap inputMap = new java.util.HashMap();
		java.util.HashMap outputMap = new java.util.HashMap();
		inputMap.put("Order", order);
		outputMap.put("Order_1", orderOMS);
		com.ibm.wbiserver.map.MapService _serv = 
			(com.ibm.wbiserver.map.MapService)new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/wbiserver/map/MapService");
		_serv.transform("http://OrderManagement/com/touresbalon/transforms", "dataMappingCreateOrder", inputMap, outputMap, ((com.ibm.wbiserver.relationshipservice.common.ExecutionContext)__result__4));
	}
}
catch(com.ibm.wbiserver.map.exceptions.WBIMapFailureException ex){
	com.ibm.wbiserver.map.exceptions.WBIMapFailureException __result__7;
	ex.printStackTrace();
}
catch(com.ibm.wbiserver.map.exceptions.WBIMapNotFoundException ex){
	com.ibm.wbiserver.map.exceptions.WBIMapNotFoundException __result__10;
	ex.printStackTrace();
}
catch(com.ibm.wbiserver.map.exceptions.WBIMapServiceException ex){
	com.ibm.wbiserver.map.exceptions.WBIMapServiceException __result__13;
	ex.printStackTrace();
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="void"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="order" variable="true">
//    <dataOutputs target="//@executableElements.4/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Order" namespace="http://OrderManagementLib/com/touresbalon/bo"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="create Order" description="create a new Order {http://orders.oms.touresbalon.com/}" template="com.ibm.websphere.bo.BOFactory factory = &#xA;   (com.ibm.websphere.bo.BOFactory) new com.ibm.websphere.sca.ServiceManager().locateService(&quot;com/ibm/websphere/bo/BOFactory&quot;);&#xA; &lt;%return%> factory.create(&quot;http://orders.oms.touresbalon.com/&quot;,&quot;Order&quot;);">
//    <result>
//      <dataOutputs target="//@executableElements.2"/>
//      <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Order" namespace="http://orders.oms.touresbalon.com/"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@result/@dataOutputs.0" value="orderOMS" variable="true">
//    <dataOutputs target="//@executableElements.4/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Order" namespace="http://orders.oms.touresbalon.com/"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="null" assignable="false">
//    <dataOutputs target="//@executableElements.4/@parameters.2"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="dataMappingCreateOrder" description="perform mapping {0}dataMappingCreateOrder {http://OrderManagement/com/touresbalon/transforms}" template="java.util.HashMap inputMap = new java.util.HashMap();&#xA;java.util.HashMap outputMap = new java.util.HashMap();&#xA;inputMap.put(&quot;Order&quot;, &lt;%Order%>);&#xA;outputMap.put(&quot;Order_1&quot;, &lt;%Order_1%>);&#xA;com.ibm.wbiserver.map.MapService _serv = &#xA;&#x9;(com.ibm.wbiserver.map.MapService)new com.ibm.websphere.sca.ServiceManager().locateService(&quot;com/ibm/wbiserver/map/MapService&quot;);&#xA;_serv.transform(&quot;http://OrderManagement/com/touresbalon/transforms&quot;, &quot;dataMappingCreateOrder&quot;, inputMap, outputMap, &lt;%executionContext%>);">
//    <parameters name="Order" dataInputs="//@executableElements.0/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Order" namespace="http://OrderManagementLib/com/touresbalon/bo"/>
//    </parameters>
//    <parameters name="Order_1" dataInputs="//@executableElements.2/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="Order" namespace="http://orders.oms.touresbalon.com/"/>
//    </parameters>
//    <parameters name="executionContext" dataInputs="//@executableElements.3/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.relationshipservice.common.ExecutionContext"/>
//    </parameters>
//    <exceptions>
//      <dataOutputs target="//@executableElements.5/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapFailureException"/>
//    </exceptions>
//    <exceptions>
//      <dataOutputs target="//@executableElements.6/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapNotFoundException"/>
//    </exceptions>
//    <exceptions>
//      <dataOutputs target="//@executableElements.7/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapServiceException"/>
//    </exceptions>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ExceptionHandler" name="Exception Handler" collapsed="true">
//    <parameters name="ex" dataInputs="//@executableElements.4/@exceptions.0/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapFailureException"/>
//    </parameters>
//    <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="ex" input="true">
//      <dataOutputs target="//@executableElements.5/@executableElements.1/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapFailureException"/>
//    </executableElements>
//    <executableElements xsi:type="com.ibm.wbit.activity:JavaActivity" name="printStackTrace" category="java.lang.Throwable" className="java.lang.Throwable" memberName="printStackTrace">
//      <parameters name="Throwable" dataInputs="//@executableElements.5/@executableElements.0/@dataOutputs.0">
//        <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Throwable"/>
//      </parameters>
//    </executableElements>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ExceptionHandler" name="Exception Handler" collapsed="true">
//    <parameters name="ex" dataInputs="//@executableElements.4/@exceptions.1/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapNotFoundException"/>
//    </parameters>
//    <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="ex" input="true">
//      <dataOutputs target="//@executableElements.6/@executableElements.1/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapNotFoundException"/>
//    </executableElements>
//    <executableElements xsi:type="com.ibm.wbit.activity:JavaActivity" name="printStackTrace" category="java.lang.Throwable" className="java.lang.Throwable" memberName="printStackTrace">
//      <parameters name="Throwable" dataInputs="//@executableElements.6/@executableElements.0/@dataOutputs.0">
//        <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Throwable"/>
//      </parameters>
//    </executableElements>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ExceptionHandler" name="Exception Handler" collapsed="true">
//    <parameters name="ex" dataInputs="//@executableElements.4/@exceptions.2/@dataOutputs.0">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapServiceException"/>
//    </parameters>
//    <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="ex" input="true">
//      <dataOutputs target="//@executableElements.7/@executableElements.1/@parameters.0"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.wbiserver.map.exceptions.WBIMapServiceException"/>
//    </executableElements>
//    <executableElements xsi:type="com.ibm.wbit.activity:JavaActivity" name="printStackTrace" category="java.lang.Throwable" className="java.lang.Throwable" memberName="printStackTrace">
//      <parameters name="Throwable" dataInputs="//@executableElements.7/@executableElements.0/@dataOutputs.0">
//        <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Throwable"/>
//      </parameters>
//    </executableElements>
//  </executableElements>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!2:1,6
//!SMAP!3:7,1
//!SMAP!4:8,1
//!SMAP!5:10,9
//!SMAP!7:21,1
//!SMAP!8:22,1
//!SMAP!10:25,1
//!SMAP!11:26,1
//!SMAP!13:29,1
//!SMAP!14:30,1
//!SMAP!1000000:140,1]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="Snippet" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Validate Order" wpc:id="6">
      <wpc:script>
        <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Validate Order...." + order.getString("orderID");
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Validate Order....&quot; + order.orderID" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="Invoke1" operation="requiresApproval" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Validate Order" wpc:id="17">
      <wpc:input>
        <wpc:parameter name="request" variable="orderOMS"/>
      </wpc:input>
      <wpc:output>
        <wpc:parameter name="response" variable="returnValidateOrder"/>
      </wpc:output>
    </bpws:invoke>
    <bpws:switch name="Choice" wpc:displayName="Check that order requires approval" wpc:id="19">
      <bpws:case wpc:displayName="Requires approval ?" wpc:id="20">
        <bpws:condition expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[($returnValidateOrder =true())]]></bpws:condition>
        <bpws:sequence name="HiddenSequence1" wpc:id="1073741849">
          <bpws:assign name="Assign1" wpc:displayName="Assign Order EN_VALIDACION" wpc:id="35">
            <bpws:copy>
              <bpws:from><![CDATA[EN_VALIDACION]]></bpws:from>
              <bpws:to variable="orderOMS">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[status]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="UpdateOrder--EN_VALIDACION" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Order -- EN_VALIDACION" wpc:id="30">
            <wpc:input>
              <wpc:parameter name="request" variable="orderOMS"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="response" variable="returnUpateOrder"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:invoke name="SalesOfficerAuthorization" operation="authorize" partnerLink="null" portType="ns6:SalesAuthorizationIF" wpc:continueOnError="inherit" wpc:displayName="Sales officer authorization" wpc:id="22" wpc:transactionalBehavior="participates">
            <wpc:task name="tel:OrderProcessingBPTask1"/>
            <wpc:input>
              <wpc:parameter name="order" variable="order"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="approved" variable="returnAppovalOrder"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:switch name="Choice1" wpc:displayName="Verify sales response" wpc:id="27">
            <bpws:case wpc:displayName="Approved purchase order sales" wpc:id="28">
              <bpws:condition expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[($returnAppovalOrder =true())]]></bpws:condition>
              <bpws:invoke name="Log-Orderapproved" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log -Order approved " wpc:id="26">
                <wpc:script>
                  <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Order approved ";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Order approved &quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:case>
            <bpws:otherwise wpc:id="29">
              <bpws:sequence name="HiddenSequence2" wpc:id="1073741856">
                <bpws:invoke name="Snippet3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Order rejected" wpc:id="33">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Order rejected";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Order rejected&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="Assign2" wpc:displayName="Assign Order RECHAZADA" wpc:id="36">
                  <bpws:copy>
                    <bpws:from><![CDATA[RECHAZADA]]></bpws:from>
                    <bpws:to variable="orderOMS">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[status]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="UpdateOrder--RECHAZADA" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Order -- RECHAZADA" wpc:id="31">
                  <wpc:input>
                    <wpc:parameter name="request" variable="orderOMS"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="response" variable="returnUpateOrder"/>
                  </wpc:output>
                </bpws:invoke>
                <bpws:terminate name="Terminate" wpc:displayName="Order rejected" wpc:id="40"/>
              </bpws:sequence>
            </bpws:otherwise>
          </bpws:switch>
        </bpws:sequence>
      </bpws:case>
      <bpws:otherwise wpc:id="21">
        <bpws:invoke name="Snippet1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Order approved" wpc:id="24">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Order approved....";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Order approved....&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
      </bpws:otherwise>
    </bpws:switch>
    <bpws:invoke name="Snippet2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Order on reservation" wpc:id="41">
      <wpc:script>
        <wpc:javaCode><![CDATA[java.lang.String __result__1 = " Order on reservation";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot; Order on reservation&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="Assign4" wpc:displayName="Assign Order EN_RESERVACION" wpc:id="39">
      <bpws:copy>
        <bpws:from><![CDATA[EN_RESERVACION]]></bpws:from>
        <bpws:to variable="orderOMS">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[status]]></bpws:query>
        </bpws:to>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="Invoke2" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Oder -- EN_RESERVACION" wpc:id="38">
      <wpc:input>
        <wpc:parameter name="request" variable="orderOMS"/>
      </wpc:input>
      <wpc:output>
        <wpc:parameter name="response" variable="returnUpateOrder"/>
      </wpc:output>
    </bpws:invoke>
    <bpws:scope name="Reservation" wpc:displayName="Reservation" wpc:id="46">
      <bpws:faultHandlers>
        <bpws:catchAll wpc:id="82">
          <bpws:sequence name="HiddenSequence7" wpc:id="1073741987">
            <bpws:invoke name="Snippet6" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Error Reservation" wpc:id="85">
              <wpc:script>
                <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Log - Error Reservation";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Log - Error Reservation&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:compensate name="Compensate" wpc:displayName="Compensate" wpc:id="164"/>
            <bpws:assign name="Assign5" wpc:displayName="Assign Order RECHAZADA" wpc:id="76">
              <bpws:copy>
                <bpws:from><![CDATA[RECHAZADA]]></bpws:from>
                <bpws:to variable="orderOMS">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[status]]></bpws:query>
                </bpws:to>
              </bpws:copy>
            </bpws:assign>
            <bpws:invoke name="Invoke6" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Oder -- RECHAZADA" wpc:id="77">
              <wpc:input>
                <wpc:parameter name="request" variable="orderOMS"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="response" variable="returnUpateOrder"/>
              </wpc:output>
            </bpws:invoke>
            <bpws:terminate name="Terminate1" wpc:displayName="Cancel Reservation" wpc:id="73"/>
          </bpws:sequence>
        </bpws:catchAll>
      </bpws:faultHandlers>
      <bpws:sequence name="HiddenSequence5" wpc:id="1073741898">
        <bpws:invoke name="Invoke3" operation="makeReservationAccommodation" partnerLink="ProductReservationServiceIFPartner" portType="ns7:ProductReservationServiceIF" wpc:continueOnError="inherit" wpc:displayName="makeReservationAccommodation" wpc:id="44">
          <wpc:input>
            <wpc:parameter name="request" variable="order"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="response" variable="returnMakeReservationAcco"/>
          </wpc:output>
          <bpws:compensationHandler>
            <bpws:sequence name="HiddenSequence3" wpc:id="1073741983">
              <bpws:invoke name="Snippet4" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Compensation   Accommodation" wpc:id="66">
                <wpc:script>
                  <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Compensation Reseration Accommodation";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Compensation Reseration Accommodation&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="Invoke5" operation="cancelReservationAccomodation" partnerLink="ProductReservationServiceIFPartner" portType="ns7:ProductReservationServiceIF" wpc:continueOnError="inherit" wpc:displayName="cancelReservationAccommo" wpc:id="51">
                <wpc:input>
                  <wpc:parameter name="request" variable="order"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="response" variable="returnCancelReservation"/>
                </wpc:output>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:compensationHandler>
        </bpws:invoke>
        <bpws:invoke name="Invoke4" operation="makeReservationTransport" partnerLink="ProductReservationServiceIFPartner" portType="ns7:ProductReservationServiceIF" wpc:continueOnError="inherit" wpc:displayName="makeReservationTransport" wpc:id="45">
          <wpc:input>
            <wpc:parameter name="request" variable="order"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="response" variable="returnMakeReservationTrans"/>
          </wpc:output>
          <bpws:compensationHandler>
            <bpws:sequence name="HiddenSequence11" wpc:id="1073741984">
              <bpws:invoke name="Snippet11" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Compensation Transportation" wpc:id="161">
                <wpc:script>
                  <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Compensation Reseration Transportation";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Compensation Reseration Transportation&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="Invoke12" operation="cancelReservationTransport" partnerLink="ProductReservationServiceIFPartner" portType="ns7:ProductReservationServiceIF" wpc:continueOnError="inherit" wpc:displayName="cancelReservationTransport" wpc:id="162">
                <wpc:input>
                  <wpc:parameter name="request" variable="order"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="response" variable="returnCancelReservation"/>
                </wpc:output>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:compensationHandler>
        </bpws:invoke>
        <bpws:flow name="ParallelActivities" wpc:displayName="ParallelActivities" wpc:id="180">
          <bpws:receive name="Receive1" operation="confirm" partnerLink="TransportCallbackIF" portType="ns13:TransportCallbackIF" wpc:displayName="Receive Transportation Confirm" wpc:id="176">
            <wpc:output>
              <wpc:parameter name="response" variable="transportResponse"/>
            </wpc:output>
            <bpws:correlations>
              <bpws:correlation initiate="no" set="OrderID_CS"/>
            </bpws:correlations>
          </bpws:receive>
          <bpws:receive name="Receive2" operation="confirm" partnerLink="AccommodationCallbackIF" portType="ns14:AccommodationCallbackIF" wpc:displayName="Receive Accommodation Confirm" wpc:id="181">
            <wpc:output>
              <wpc:parameter name="response" variable="lodgingResponse"/>
            </wpc:output>
            <bpws:correlations>
              <bpws:correlation initiate="no" set="OrderID_CS"/>
            </bpws:correlations>
          </bpws:receive>
        </bpws:flow>
        <bpws:invoke name="Snippet5" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Complete Reservation " wpc:id="75">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.String __result__1 = "Log - Complete Reservation ";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;Log - Complete Reservation &quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:invoke name="HumanTask" operation="confirm" partnerLink="null" portType="ns9:SecureTicketingIF" wpc:continueOnError="inherit" wpc:displayName="Secure Ticketing" wpc:id="87" wpc:transactionalBehavior="participates">
          <wpc:task name="tel1:OrderProcessingBPTask3"/>
          <wpc:input>
            <wpc:parameter name="request" variable="order"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="productConfirmed" variable="productConfirm"/>
          </wpc:output>
        </bpws:invoke>
        <bpws:invoke name="Snippet7" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - Secue Ticketing Executed" wpc:id="96">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.String __result__1 = " Secue Ticketing Executed";
{// print to log
	System.out.println(__result__1);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot; Secue Ticketing Executed&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="print to log" description="Print a text representation of the input to System.out" category="utility" template="System.out.println(&lt;%object%>);">
//    <parameters name="object" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,3
//!SMAP!1000000:29,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
      </bpws:sequence>
    </bpws:scope>
    <bpws:switch name="Choice2" wpc:displayName="Product confirmed ?" wpc:id="89">
      <bpws:case wpc:displayName="Yes" wpc:id="90">
        <bpws:condition expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[($productConfirm =true())]]></bpws:condition>
        <bpws:sequence name="HiddenSequence8" wpc:id="1073741918">
          <bpws:assign name="Assign6" wpc:displayName="Assign Payment" wpc:id="95">
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[creditCard/number]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[number]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[creditCard/expiration]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[expiration]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[customer/firstName]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[holderFirstName]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[customer/lastName]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[holderLastName]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[customer/emailAddress]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[emailAddress]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[creditCard/securityCode]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[cardSecurityCode]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[creditCard/type]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[cardType]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="order">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[amount]]></bpws:query>
              </bpws:from>
              <bpws:to variable="payment">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[amount]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="Invoke8" operation="applyPayment" partnerLink="PaymentServiceIFPartner" portType="ns10:PaymentServiceIF" wpc:continueOnError="inherit" wpc:displayName="Apply Payment" wpc:id="93">
            <wpc:input>
              <wpc:parameter name="request" variable="payment"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="response" variable="returnApplyPayment"/>
            </wpc:output>
          </bpws:invoke>
          <bpws:invoke name="Snippet8" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Order CERRADA" wpc:id="110">
            <wpc:script>
              <wpc:javaCode><![CDATA[java.util.Date __result__1;
{// current date and time
	__result__1 = new java.util.Date();
}
order.setDate("endOrderDate", __result__1);
orderOMS.setDate("endOrderDate", __result__1);
java.lang.String __result__3 = "CERRADA";
orderOMS.setString("status", __result__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="current date and time" description="The current date and time" category="date" template="&lt;%return%> new java.util.Date();">
//    <result name="dateTimeNow" displayName="date time now">
//      <dataOutputs target="//@executableElements.1"/>
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.Date"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@result/@dataOutputs.0" value="order.endOrderDate" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="dateTime" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="&quot;CERRADA&quot;" assignable="false">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@result/@dataOutputs.1" value="orderOMS.endOrderDate" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="dateTime" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.2/@dataOutputs.0" value="orderOMS.status" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="string" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//  <executableGroups executableElements="//@executableElements.3"/>
//  <executableGroups executableElements="//@executableElements.2 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,4
//!SMAP!2:5,1
//!SMAP!3:7,1
//!SMAP!4:6,1
//!SMAP!5:8,1
//!SMAP!1000000:49,1]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:flow name="ParallelActivities1" wpc:displayName="ParallelActivities" wpc:id="99">
            <bpws:invoke name="Invoke10" operation="legalize" partnerLink="LegalizeOrderServiceIFPartner" portType="ns12:LegalizeOrderServiceIF" wpc:continueOnError="inherit" wpc:displayName="Legalize Order" wpc:id="105">
              <wpc:input>
                <wpc:parameter name="request" variable="order"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="response" variable="returnLegalizeOrder"/>
              </wpc:output>
            </bpws:invoke>
            <bpws:invoke name="Invoke9" operation="updateOrder" partnerLink="OrderMgmtServiceIFPartner" portType="ns4:OrderMgmtServiceIF" wpc:continueOnError="inherit" wpc:displayName="Update Oder -- CERRADA" wpc:id="100">
              <wpc:input>
                <wpc:parameter name="request" variable="orderOMS"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="response" variable="returnUpateOrder"/>
              </wpc:output>
            </bpws:invoke>
          </bpws:flow>
        </bpws:sequence>
      </bpws:case>
      <bpws:otherwise wpc:id="91">
        <bpws:throw faultName="ns8:CancellProcess" name="Throw" wpc:displayName="Could not buy ticketing" wpc:id="78"/>
      </bpws:otherwise>
    </bpws:switch>
  </bpws:sequence>
</bpws:process>